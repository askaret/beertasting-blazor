@using Microsoft.Identity.Web
@using Microsoft.Graph
@using BlazorTest.ViewModels
@using DataAccessLibrary
@using DataAccessLibrary.Models
@using System.Globalization
@using System.ComponentModel.DataAnnotations

<MudNavMenu>
    <MudNavLink Href="/">Home</MudNavLink>
    <MudNavLink Icon="@Icons.Material.Outlined.VerifiedUser" Href="/profile">Profile</MudNavLink>
    <MudNavLink Icon="@Icons.Material.Outlined.HowToVote" Href="/tasting">Beertasting</MudNavLink>
    @if (_taster is not null && _taster.IsAdmin)
    {
        <MudNavGroup Icon="@Icons.Material.Outlined.AdminPanelSettings" Title="Admin" Expanded="true">
            <MudNavLink Icon="@Icons.Material.Outlined.LocalDrink" Href="/admin/beer">Beers</MudNavLink>
            <MudNavLink Icon="@Icons.Material.Outlined.Business" Href="/admin/brewery">Breweries</MudNavLink>
            <MudNavLink Icon="@Icons.Material.Outlined.CalendarToday" Href="/admin/tasting">Tastings</MudNavLink>
            <MudNavLink Icon="@Icons.Material.Outlined.SupervisorAccount" Href="/admin/taster">Tasters</MudNavLink>
        </MudNavGroup>
    }
    <AuthorizeView>
        <Authorized>
            <MudNavLink Href="MicrosoftIdentity/Account/SignOut" Icon="@Icons.Material.Outlined.Logout">Logout</MudNavLink>
        </Authorized>
        <NotAuthorized>
            <MudNavLink Href="MicrosoftIdentity/Account/SignIn" Icon="@Icons.Material.Outlined.Login">Login</MudNavLink>
        </NotAuthorized>
    </AuthorizeView>
</MudNavMenu>

@code {
    private BrowserStorageHelper? _browserStorage = new BrowserStorageHelper();
    private TasterModel? _taster;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        //if(_taster is null)
        //{
        //    var t = await _browserStorage?.LoadFromSessionStorage<TasterModel>("taster");
        //    _taster = t;
        //    //StateHasChanged();
        //}

        await base.OnAfterRenderAsync(firstRender);
    }

    protected override async Task OnInitializedAsync()
    {
        
    }
}